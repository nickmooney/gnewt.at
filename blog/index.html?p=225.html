<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
<title>  Bi-directional Caller ID Spoofing with Asterisk | Gnewt&#039;s Blag</title>
<meta name="description" content="Bi-directional Caller ID Spoofing with Asterisk" />
<link rel="alternate" type="application/rss+xml" title="Gnewt&#039;s Blag RSS Feed" href="feed/index.html" />
<link rel="alternate" type="application/atom+xml" title="Gnewt&#039;s Blag Atom Feed" href="feed/atom/index.html" /> 
<link rel="pingback" href="http://www.gnewt.at/blog/xmlrpc.php" />

<link rel="stylesheet" href="wp-content/themes/monochrome/style.css" type="text/css" />
<link rel="stylesheet" href="wp-content/themes/monochrome/comment-style.css" type="text/css" />
<!--[if lt IE 7]>
<link rel="stylesheet" href="http://www.gnewt.at/blog/wp-content/themes/monochrome/ie6.css" type="text/css" />
<![endif]--> 
<style type="text/css">
.post img, .post a img { border:1px solid #ccc; padding:5px; margin:0 10px 0 0;  background:#f2f2f2; }
.post a:hover img { border:1px solid #38a1e5; background:#9cd1e1; }
.post img.wp-smiley { border:0px; padding:0px; margin:0px; background:none; }
</style>

 
<link rel='dns-prefetch' href='http://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="Gnewt&#039;s Blag &raquo; Bi-directional Caller ID Spoofing with Asterisk Comments Feed" href="2012/07/asterisk-bidirectional-cid-spoofing/feed/index.html" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.gnewt.at\/blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.7.2"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),!(j.toDataURL().length<3e3)&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,65039,8205,55356,57096),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,55356,57096),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55357,56425,55356,57341,8205,55357,56507),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55357,56425,55356,57341,55357,56507),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<!-- This site uses the Google Analytics by MonsterInsights plugin v5.5.4 - Universal enabled - https://www.monsterinsights.com/ -->
<script type="text/javascript">
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

	__gaTracker('create', 'UA-32955882-1', 'auto');
	__gaTracker('set', 'forceSSL', true);
	__gaTracker('send','pageview');

</script>
<!-- / Google Analytics by MonsterInsights -->
<script type='text/javascript' src='wp-includes/js/jquery/jquery.js%3Fver=1.12.4'></script>
<script type='text/javascript' src='wp-includes/js/jquery/jquery-migrate.min.js%3Fver=1.4.1'></script>
<link rel='https://api.w.org/' href='wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="xmlrpc.php%3Frsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Arduino, Circular Linked Lists, and Christmas Lights' href='index.html%3Fp=192.html' />
<link rel='next' title='Scripting an Ice Cream Delivery with the Android SDK' href='index.html%3Fp=235.html' />
<meta name="generator" content="WordPress 4.7.2" />
<link rel="canonical" href="index.html%3Fp=225.html" />
<link rel='shortlink' href='index.html%3Fp=225.html' />
<link rel="alternate" type="application/json+oembed" href="wp-json/oembed/1.0/embed%3Furl=http%253A%252F%252Fwww.gnewt.at%252Fblog%252F2012%252F07%252Fasterisk-bidirectional-cid-spoofing%252F" />
<link rel="alternate" type="text/xml+oembed" href="wp-json/oembed/1.0/embed%3Furl=http%253A%252F%252Fwww.gnewt.at%252Fblog%252F2012%252F07%252Fasterisk-bidirectional-cid-spoofing%252F&amp;format=xml" />
<style type="text/css" id="syntaxhighlighteranchor"></style>
<script type="text/javascript" src="wp-content/themes/monochrome/js/scroll.js"></script>
<script type="text/javascript" src="wp-content/themes/monochrome/js/jscript.js"></script>
<script type="text/javascript" src="wp-content/themes/monochrome/js/comment.js"></script>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-15905622-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</head>

<body>
<div id="wrapper">

 <div id="header">

  <div id="header_top">

   <div id="logo">
       <a href="../index.html">Gnewt&#039;s Blag</a>
    <h1>She turned me into a Gnewt! I got better&#8230;</h1>
      </div>

      <div class="header_menu">
    <ul class="menu">
     <li class="page_item"><a href="../index.html">HOME</a></li>
     <li class="page_item page-item-2"><a href="index.html%3Fp=2.html">/usr/bin/whoami</a></li>
    </ul>
   </div>
   
  </div>

  </div><!-- #header end -->  <div id="contents" class="clearfix">

   <div id="left_col">

        <div id="header_meta">
     <ul id="bread_crumb" class="clearfix">
      <li id="bc_home"><a href="../index.html">HOME</a></li>
      <li id="bc_cat"><a href="category/uncategorized/index.html" rel="category tag">Uncategorized</a></li>
      <li>Bi-directional Caller ID Spoofing with Asterisk</li>
     </ul>
    </div>
    

    <div class="post clearfix" id="single_post">
     <div class="post_content_wrapper">
      <h2 class="post_title"><span>Bi-directional Caller ID Spoofing with Asterisk</span></h2>
      <div class="post_content">
       <p>Caller ID spoofing has been around for a long time. Way back when (well, 2004), an <a href="http://www.rootsecure.net/?p=reports/callerid_spoofing" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.rootsecure.net/?p=reports/callerid_spoofing', 'article');">article</a> was published on rootsecure.net with an included Perl script, detailing how to use Asterisk to change your caller ID information, in order to pretend to be somebody else. I had some fun toying with that (<a href="http://vimeo.com/4420607" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://vimeo.com/4420607', 'heh.');">heh.</a>..), and noticed that some commercial services began to pop up which offered the same capability for a price. SpoofCard is the one that I&#8217;ve seen around the most, but many exist. Bah. Setting up an Asterisk server is free if you have access to a Linux box, and outbound SIP trunking is dead cheap. With flowroute.com, I pay less than a cent per minute to place calls within the U.S. The perl script, obviously, is also free.</p>
<p>The other day I saw something as part of a commercial spoofing service that I hadn&#8217;t seen before: <a href="http://www.prankdial.com/pranks/eviloperator" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.prankdial.com/pranks/eviloperator', 'bidirectional caller ID spoofing');">bidirectional caller ID spoofing</a>. Basically, it will call friend A from friend B&#8217;s number, friend B from friend A&#8217;s number, and record the result. This leads to something along the lines of &#8220;You called me!&#8221; &#8220;No, you called me!&#8221; As fun as that is, websites like PrankDial are charging a lot of money to do something that is, in practice, very simple.</p>
<p>I haven&#8217;t seen a script to do this posted on the internet yet, so I created one and <a href="https://github.com/Gnewt/asterisk-dual-cid-spoof" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/Gnewt/asterisk-dual-cid-spoof', 'put it on github');">put it on github</a>. You&#8217;ll have to set up the Asterisk server by yourself, but implementing the script is easy.</p>
<ol>
<li>Put dual_cid_spoof.py in the /usr/share/asterisk/agi-bin directory</li>
<li>Make it executable to the asterisk user</li>
<li>Add an extension to extensions.conf that calls the script, using pattern matching to give it arguments. For example:</li>
</ol>
<pre>[spoof]
exten =&gt; _37NXXNXXXXXXNXXNXXXXXX,1,Answer
exten =&gt; _37NXXNXXXXXXNXXNXXXXXX,2,AGI(dualcidspoof.py,${EXTEN:2:10},${EXTEN:12:10})</pre>
<p>This uses the extension 37, but that part can be changed. This pattern matches any calls that have the number 37 followed by two 10-digit phone numbers, and then pulls those numbers out and uses them as arguments to the AGI script ${EXTEN:2:10} means take the extension, at index 2, and pull out 10 digits. To execute it with phone numbers 123-123-1111 and 222-202-2020, I would dial 3712312311112222022020.</p>
<p><a href="http://www.voip-info.org/wiki/view/Asterisk+cmd+MeetMe" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.voip-info.org/wiki/view/Asterisk+cmd+MeetMe', 'MeetMe');">MeetMe</a> is required to use this script, since it works by placing both users into a conference room together. The default conference room number is 1234, but that can be changed in the script. Also necessary is changing the outgoing SIP trunk in the Python script from &#8220;flowroute&#8221; to whatever the name of your outgoing SIP trunk is. Both of these are variables at the top of the script. Execution flow works like this:</p>
<ul>
<li>Create two .call files, each with opposite CID/destination info. These files are set to dump the callees into a conference room when they answer.</li>
<li>Place the files in /var/spool/outgoing/asterisk, to be automatically processed by the Asterisk spooler.</li>
<li>Connect you into the same conference room as a muted admin, giving you the ability to kick users and listen without being heard.</li>
</ul>
<p>Enjoy, and feel free to ask questions. Again, you can get the script <a href="https://github.com/Gnewt/asterisk-dual-cid-spoof" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/Gnewt/asterisk-dual-cid-spoof', 'here');">here</a>.</p>
             </div>
     </div>
     <dl class="post_meta">
        <dt class="meta_date">2012</dt>
         <dd class="post_date">07<span>/03</span></dd>
                <dt>CATEGORY</dt>
         <dd><a href="category/uncategorized/index.html" rel="category tag">Uncategorized</a></dd>
                                 <dt class="meta_comment"><a href="index.html%3Fp=225.html#comments"><span class="dsq-postid" data-dsqidentifier="225 http://www.gnewt.at/blog/?p=225">5 comments</span></a></dt>
             </dl>
    </div>


    <div id="comments_wrapper">
     
<div id="disqus_thread">
            <div id="dsq-content">


            <ul id="dsq-comments">
                    <li class="comment even thread-even depth-1" id="dsq-comment-10782">
        <div id="dsq-comment-header-10782" class="dsq-comment-header">
            <cite id="dsq-cite-10782">
                <span id="dsq-author-user-10782">Hurp</span>
            </cite>
        </div>
        <div id="dsq-comment-body-10782" class="dsq-comment-body">
            <div id="dsq-comment-message-10782" class="dsq-comment-message"><p>Now, all you need to do is hook this up to your local white-pages directory and do some random pairing. Farm the recordings to a website, and have users vote for the funniest calls.</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="post pingback">
        <p>Pingback: <a href='http://www.isdpodcast.com/episode-714-asterisk-assad-emails-emergency-communications-bestbuy' rel='external nofollow' class='url'>Episode 714 &#8211; Asterisk, Assad Emails, Emergency Communications &amp; BestBuy | InfoSec Daily</a>()</p>
    </li>
    </li><!-- #comment-## -->
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-11846">
        <div id="dsq-comment-header-11846" class="dsq-comment-header">
            <cite id="dsq-cite-11846">
                <span id="dsq-author-user-11846">Nobody</span>
            </cite>
        </div>
        <div id="dsq-comment-body-11846" class="dsq-comment-body">
            <div id="dsq-comment-message-11846" class="dsq-comment-message"><p>Can you explain how  this works? I am unfamiliar with Perl scripting.<br />
Thanks</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-even depth-1" id="dsq-comment-12243">
        <div id="dsq-comment-header-12243" class="dsq-comment-header">
            <cite id="dsq-cite-12243">
                <span id="dsq-author-user-12243">John</span>
            </cite>
        </div>
        <div id="dsq-comment-body-12243" class="dsq-comment-body">
            <div id="dsq-comment-message-12243" class="dsq-comment-message"><p>Can you be kind enough to provide the two .call files as examples?</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment byuser comment-author-admin bypostauthor odd alt thread-odd thread-alt depth-1" id="dsq-comment-12330">
        <div id="dsq-comment-header-12330" class="dsq-comment-header">
            <cite id="dsq-cite-12330">
                <span id="dsq-author-user-12330">Gnewt</span>
            </cite>
        </div>
        <div id="dsq-comment-body-12330" class="dsq-comment-body">
            <div id="dsq-comment-message-12330" class="dsq-comment-message"><p>The .call files are generated dynamically by the Python script&#8211; check out the source.</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment byuser comment-author-admin bypostauthor even thread-even depth-1" id="dsq-comment-12332">
        <div id="dsq-comment-header-12332" class="dsq-comment-header">
            <cite id="dsq-cite-12332">
                <span id="dsq-author-user-12332">Gnewt</span>
            </cite>
        </div>
        <div id="dsq-comment-body-12332" class="dsq-comment-body">
            <div id="dsq-comment-message-12332" class="dsq-comment-message"><p>This is Python, but the &#8216;fun parts&#8217; don&#8217;t rely on Python at all. Reading <a href="http://www.voip-info.org/wiki/view/Asterisk+auto-dial+out" onclick="__gaTracker('send', 'event', 'outbound-comment', 'http://www.voip-info.org/wiki/view/Asterisk+auto-dial+out', 'this page');" rel="nofollow">this page</a> should help you understand Asterisk&#8217;s .call file functionality. The Python script just generates the .call files dynamically.</p>
</div>
        </div>

    </li><!-- #comment-## -->
            </ul>


        </div>

    </div>

    </div>

        <div id="previous_next_post" class="clearfix">
     <p id="previous_post"><a href="index.html%3Fp=192.html" rel="prev">Arduino, Circular Linked Lists, and Christmas Lights</a></p>
     <p id="next_post"><a href="index.html%3Fp=235.html" rel="next">Scripting an Ice Cream Delivery with the Android SDK</a></p>
    </div>
    
   </div><!-- #left_col end -->

   <div id="right_col">
  
    <div id="information_area" class="clearfix">
   <div class="side_box" id="information">
    <h3>Information</h3>
    <div id="information_contents">I'm Gnewt and I make things.</div>
   </div>
      <div id="entries_rss">
    <a href="feed/index.html" title="Entries RSS" >RSS FEED</a>
   </div>
     </div>
  
    <div class="side_box" id="search_area_top">
   <div id="search_area" class="clearfix">
        <form method="get" id="searchform" action="../index.html">
     <div><input type="text" value="Search" name="s" id="search_input" onfocus="this.value=''; changefc('white');" /></div>
     <div><input type="image" src="wp-content/themes/monochrome/img/search_button.gif" alt="Search from this blog." title="Search from this blog." id="search_button" /></div>
    </form>
       </div>
     </div>
  
  
   <div class="side_box">
   <h3>Recent entry</h3>
    <ul>
     <li class="side_date">2014-04-14</li>
     <li><a href="index.html%3Fp=291.html">BHS Shirt Sales with Django</a></li>
     <li class="side_date">2014-01-14</li>
     <li><a href="index.html%3Fp=276.html">What Would the Bhagavad Gita Say?</a></li>
     <li class="side_date">2013-09-15</li>
     <li><a href="index.html%3Fp=250.html">Weekend Project: Web-controlled Christmas Lights with Node.js, Arduino, and Raspberry Pi</a></li>
     <li class="side_date">2013-08-18</li>
     <li><a href="index.html%3Fp=244.html">Publishing Data to Redis with Django Signals</a></li>
     <li class="side_date">2012-07-13</li>
     <li><a href="index.html%3Fp=235.html">Scripting an Ice Cream Delivery with the Android SDK</a></li>
   </ul>
  </div>

   <div class="side_box">
   <h3>Archive</h3>
   <ul>
    	<li><a href='2014/04/index.html'>April 2014</a></li>
	<li><a href='2014/01/index.html'>January 2014</a></li>
	<li><a href='2013/09/index.html'>September 2013</a></li>
	<li><a href='2013/08/index.html'>August 2013</a></li>
	<li><a href='2012/07/index.html'>July 2012</a></li>
	<li><a href='2012/06/index.html'>June 2012</a></li>
	<li><a href='2011/05/index.html'>May 2011</a></li>
	<li><a href='2010/05/index.html'>May 2010</a></li>
	<li><a href='2010/04/index.html'>April 2010</a></li>
	<li><a href='2009/10/index.html'>October 2009</a></li>
	<li><a href='2009/03/index.html'>March 2009</a></li>
   </ul>
   </div>

   <div class="side_box">
   <h3>Category</h3>
   <ul>
    	<li class="cat-item cat-item-23"><a href="category/code/index.html" >Code</a>
</li>
	<li class="cat-item cat-item-1"><a href="category/uncategorized/index.html" >Uncategorized</a>
</li>
   </ul>
   </div>


  
</div><!-- #right_col end -->
  </div><!-- #contents end -->

  <div id="footer">
   <ul id="copyright">
    <li style="background:none;">
                Copyright &copy;&nbsp; 2009-2017     &nbsp;<a href="../index.html">Gnewt&#039;s Blag</a></li>
    <li><a href="http://www.mono-lab.net/">Theme designed by mono-lab</a></li>
    <li><a href="http://wordpress.org/">Powered by WordPress</a></li>
   </ul>
  </div>
 
</div><!-- #wrapper end -->

<div id="return_top">
 <a href="index.html%3Fp=225.html#wrapper">&nbsp;</a>
</div>

<script type='text/javascript' src='wp-includes/js/comment-reply.min.js%3Fver=4.7.2'></script>
<script type='text/javascript' src='wp-includes/js/wp-embed.min.js%3Fver=4.7.2'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"platform":"wordpress@4.7.2","language":""},"disqusIdentifier":"225 http:\/\/www.gnewt.at\/blog\/?p=225","disqusShortname":"gnewt","disqusTitle":"Bi-directional Caller ID Spoofing with Asterisk","disqusUrl":"http:\/\/www.gnewt.at\/blog\/2012\/07\/asterisk-bidirectional-cid-spoofing\/","options":{"manualSync":false},"postId":"225"};
/* ]]> */
</script>
<script type='text/javascript' src='wp-content/plugins/disqus-comment-system/media/js/disqus.js%3Fver=4.7.2'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"gnewt"};
/* ]]> */
</script>
<script type='text/javascript' src='wp-content/plugins/disqus-comment-system/media/js/count.js%3Fver=4.7.2'></script>
</body>
</html>
<!-- Dynamic page generated in 0.060 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2017-02-01 13:12:33 -->
